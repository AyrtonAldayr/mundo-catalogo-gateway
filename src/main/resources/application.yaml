# Configuración común a todos los ambientes.
# Perfiles:
#   local          - sin Config Server (solo YAML local)
#   local-config   - con Config Server en localhost:8888 (optional)
#   desarrollo     - con Config Server (optional)
#   produccion     - con Config Server (optional)
# Activar: --spring.profiles.active=local | local-config | desarrollo | produccion (por defecto: local)

spring:
  application:
    name: mundo-catalogo-gateway
  profiles:
    active: local
  # Config Client: obligatorio declarar si se usa Config Server (2.4+).
  # Este valor (sin URL) es el que se usa cuando NO se usa Config Server (ej. perfil local).
  # Los perfiles que sí usan Config Server definen la URL en su application-<perfil>.yml.
  config:
    import: "optional:configserver:"

# Mensajes de error del gateway (i18n): ver src/main/resources/messages.yml (idioma según Accept-Language).

# URLs de las APIs (backends). Se definen por perfil en application-<perfil>.yml bajo
# spring.cloud.gateway.server.webflux.routes. Ejemplo de estructura:
#
#   spring:
#     cloud:
#       gateway:
#         server:
#           webflux:
#             routes:
#               - id: catalog-api
#                 uri: http://localhost:8081    # API de catálogo (local)
#                 predicates:
#                   - Path=/api/**
#               - id: otro-servicio
#                 uri: http://localhost:8082
#                 predicates:
#                   - Path=/otro/**
#
# Perfiles: application-local.yml, application-local-config.yml, application-desarrollo.yml, application-produccion.yml.

# Headers obligatorios y expresión regular que debe cumplir cada valor (todo en un solo lugar).
# Clave = nombre del header, valor = regex. Evita inyección limitando caracteres permitidos.
# Para rutas privadas, añadir después validación de Authorization (filtro o Spring Security por path).
gateway:
  required-headers:
    enabled: true
    headers:
      X-Request-Id: "^[a-zA-Z0-9\\-]{1,64}$"
      X-Client-Id: "^[a-zA-Z0-9_\\-.]{1,64}$"
      X-Tenant-Id: "^[a-zA-Z0-9_\\-]{1,64}$"
      Accept-Language: "^[a-z]{2}(-[A-Z]{2})?$"
